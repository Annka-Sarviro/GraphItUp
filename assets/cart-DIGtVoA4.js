import"./themeToggle-sRxUQ6YT.js";function O(e,o){const a=parseInt(e.slice(1),16),d=Math.round(2.55*o),t=(a>>16)+d,u=(a>>8&255)+d,y=(a&255)+d;return`#${(16777216+(t<255?t<1?0:t:255)*65536+(u<255?u<1?0:u:255)*256+(y<255?y<1?0:y:255)).toString(16).slice(1)}`}function et(e,o,a,d,t,u,y){const b=t.clientWidth-80,l=t.clientHeight-2*40,h=100,f=(b-60)/o.length*.8,v=Math.max(...e.flat().filter(w=>!isNaN(w)&&w!=="")),S=f*.2,I=parseInt(localStorage.getItem("gridSize"))||10,N=Math.floor(v/I);for(let w=0;w<=N;w++){const m=40+l-w*I*(l/v),c=document.createElementNS("http://www.w3.org/2000/svg","line");c.setAttribute("x1",40),c.setAttribute("y1",m),c.setAttribute("x2",b+40),c.setAttribute("y2",m),c.setAttribute("stroke","var(--grey)"),t.appendChild(c);const i=(w*I).toFixed(0),n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("x",30),n.setAttribute("y",m+5),n.setAttribute("fill","var(--text-color)"),n.textContent=i,t.appendChild(n)}const T=a.reduce((w,m,c)=>(w[m]=d[c%d.length],w),{});e.forEach((w,m)=>{let c=h+m*(f+S);const i=w.map((n,r)=>({value:n,category:a[r]})).filter(({value:n})=>!isNaN(n)&&n!=="").sort((n,r)=>r.value-n.value);if(i.forEach(({value:n,category:r},E)=>{const L=n/v*l,x=document.createElementNS("http://www.w3.org/2000/svg","rect");x.setAttribute("data-category",r);const C=E>=5?O(T[r],-20):T[r];x.setAttribute("x",c),x.setAttribute("y",40+l-L),x.setAttribute("width",f),x.setAttribute("height",L),x.setAttribute("fill",C),t.appendChild(x)}),i.forEach(({value:n},r)=>{if(!isNaN(n)&&n!==""){const E=n/v*l,L=document.createElementNS("http://www.w3.org/2000/svg","text");L.setAttribute("x",c+f/2),L.setAttribute("y",40+l-E-5),L.setAttribute("fill","#000"),L.textContent=n.toFixed(0),L.setAttribute("text-anchor","middle"),t.appendChild(L)}}),o[m]!==""){const n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("x",c+f/2),n.setAttribute("y",t.clientHeight-40+15),n.setAttribute("fill","var(--text-color)"),n.textContent=o[m],n.setAttribute("text-anchor","middle"),t.appendChild(n)}});const P=document.createElementNS("http://www.w3.org/2000/svg","text");P.setAttribute("x",t.clientWidth/2),P.setAttribute("y",t.clientHeight-40+40),P.setAttribute("fill","var(--text-color)"),P.textContent=u,P.setAttribute("text-anchor","middle"),t.appendChild(P)}function nt(e,o,a,d,t,u,y,s=300){const b=e[0].map(g=>parseInt(g)).filter(g=>!isNaN(g)&&g!==""),l=b.reduce((g,f)=>g+f,0);if(l===0){console.error("Total is zero. Cannot render pie chart.");return}let h=0;b.forEach((g,f)=>{const v=g/l*2*Math.PI,S=t.clientWidth/2,I=t.clientHeight/2,N=S+s*Math.cos(h),T=I+s*Math.sin(h),P=S+s*Math.cos(h+v),w=I+s*Math.sin(h+v),m=`M ${S} ${I} L ${N} ${T} A ${s} ${s} 0 ${v>Math.PI?1:0} 1 ${P} ${w} Z`,c=document.createElementNS("http://www.w3.org/2000/svg","path");let i=0;b.length>5&&(i=Math.floor(f/5)*10);const n=O(d[f%d.length],i);if(c.setAttribute("d",m),c.setAttribute("fill",n),c.setAttribute("data-category",a[f]),t.appendChild(c),g!==0){const E=h+v/2,L=S+(s+20)*Math.cos(E),x=I+(s+20)*Math.sin(E),C=document.createElementNS("http://www.w3.org/2000/svg","text");C.setAttribute("x",L),C.setAttribute("y",x),C.setAttribute("fill","var(--text-color)"),C.setAttribute("text-anchor","middle"),C.textContent=g,t.appendChild(C)}h+=v;const r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x",t.clientWidth/2),r.setAttribute("y",I+s+40),r.setAttribute("fill","var(--text-color)"),r.setAttribute("text-anchor","middle"),r.textContent=`${o[0]}  ${u}`,t.appendChild(r)})}function ot(e,o,a,d,t,u,y){t.innerHTML="";const b=(JSON.parse(localStorage.getItem("chartData"))||[])[0].slice(1),l=40,h=t.clientWidth-2*l,g=t.clientHeight-2*l,f=e.map(c=>c.map(i=>parseInt(i)).filter(i=>!isNaN(i)&&i!=="")),v=Math.max(...f.flat()),S=parseInt(localStorage.getItem("gridSize"))||10,I=Math.floor(v/S),N=h/(f[0].length+1),T=g/v;for(let c=0;c<=I;c++){const i=l+g-c*S*T,n=document.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",l),n.setAttribute("y1",i),n.setAttribute("x2",h+l),n.setAttribute("y2",i),n.setAttribute("stroke","var(--grey)"),t.appendChild(n);const r=(c*S).toFixed(0),E=document.createElementNS("http://www.w3.org/2000/svg","text");E.setAttribute("x",l-10),E.setAttribute("y",i+5),E.setAttribute("fill","var(--text-color)"),E.textContent=r,t.appendChild(E)}const P=document.createElementNS("http://www.w3.org/2000/svg","g");f[0].forEach((c,i)=>{const n=l+N*(i+1),r=document.createElementNS("http://www.w3.org/2000/svg","line");r.setAttribute("x1",n),r.setAttribute("y1",l),r.setAttribute("x2",n),r.setAttribute("y2",g+l),r.setAttribute("stroke","var(--grey)"),P.appendChild(r)}),t.insertBefore(P,t.firstChild),e[0].map((c,i)=>f.map(n=>n[i])).forEach((c,i)=>{let n=Math.floor(i/5)*10;const r=O(d[i%d.length],n);console.log(r,c,i);let E="",L=!1;c.forEach((A,B)=>{if(A==null||isNaN(A)){L=!1;return}const k=l+N*(B+1),p=l+g-A*T;L?E+=`L ${k} ${p} `:(E+=`M ${k} ${p} `,L=!0)});const x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",E),x.setAttribute("stroke",r),x.setAttribute("fill","none"),x.setAttribute("stroke-width","2"),x.setAttribute("data-category",a[i]),t.appendChild(x);const C=document.createElementNS("http://www.w3.org/2000/svg","path");C.setAttribute("d",E),C.setAttribute("stroke","transparent"),C.setAttribute("fill","none"),C.setAttribute("stroke-width","12"),C.style.cursor="pointer",t.appendChild(C),c.forEach((A="",B)=>{if(A){const k=l+N*(B+1),p=document.createElementNS("http://www.w3.org/2000/svg","text");p.setAttribute("x",k),p.setAttribute("y",l+g-A*T-10),p.setAttribute("fill","var(--text-color)"),p.setAttribute("text-anchor","middle"),p.textContent=A||"",p.classList.add("hover-text"),t.appendChild(p)}}),C.addEventListener("mouseover",function(){x.setAttribute("stroke-width","4");const A=b.indexOf(a[i]),B=document.querySelectorAll("#dataTable tr.highlight"),k=document.querySelectorAll("#dataTable tr");B.length>0?B.forEach(p=>{const W=p.querySelector(`td:nth-child(${A+2})`);W&&W.classList.add("extra")}):k.forEach(p=>{const W=p.querySelector(`td:nth-child(${A+2})`);W&&W.classList.add("extra")})}),C.addEventListener("mouseout",function(){x.setAttribute("stroke-width","2");const A=b.indexOf(a[i]);e.length<=6&&document.querySelectorAll("#dataTable tr").forEach(p=>{const W=p.querySelector(`td:nth-child(${A+2})`);W&&W.classList.remove("extra")}),document.querySelectorAll("#dataTable .highlight").forEach((k,p)=>{p===A&&k.classList.remove("extra")})}),c.forEach((A,B)=>{if(typeof A=="number"&&!isNaN(A)){const k=l+N*(B+1),p=document.createElementNS("http://www.w3.org/2000/svg","circle");p.setAttribute("cx",k),p.setAttribute("cy",l+g-A*T),p.setAttribute("r",5),p.setAttribute("fill",r),p.setAttribute("data-category",a[i]),t.appendChild(p)}})}),f[0].forEach((c,i)=>{const n=l+N*(i+1),r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x",n),r.setAttribute("y",t.clientHeight-l+15),r.setAttribute("fill","var(--text-color)"),r.textContent=o[i],r.setAttribute("text-anchor","middle"),t.appendChild(r)});const m=document.createElementNS("http://www.w3.org/2000/svg","text");m.setAttribute("x",t.clientWidth/2),m.setAttribute("y",t.clientHeight-10),m.setAttribute("fill","#000"),m.textContent=u,t.appendChild(m)}function rt(e,o,a,d,t,u,y,s){e==="bar"?et(o,a,d,t,u,y):e==="pie"?nt(o,a,d,t,u,y):e==="line"?ot(o,a,d,t,u,y):console.error("Unknown chart type")}function at(e,o,a,d="bar"){const t=document.getElementById("legend");t.innerHTML="",e.forEach((u,y)=>{const s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.marginBottom="5px",s.style.cursor="pointer";const b=document.createElement("div");b.style.width="15px",b.style.height="15px";const l=y>=5?O(o[y%o.length],-20):o[y%o.length];b.style.backgroundColor=l,b.style.marginRight="10px";const h=document.createElement("span");h.textContent=u,s.appendChild(b),s.appendChild(h),s.addEventListener("mouseenter",()=>{U(u,!0,d)}),s.addEventListener("mouseleave",()=>{U(u,!1,d)}),t.appendChild(s)})}function U(e,o,a="bar"){document.querySelectorAll("rect, path").forEach(t=>{t.getAttribute("data-category")===e&&(o?a==="line"?t.style.strokeWidth="4px":(t.style.stroke="var(--accent-color-hover)",t.style.strokeWidth="3px"):a==="line"?t.style.strokeWidth="initial":t.style.stroke="none")})}function lt(e){const o=e[0],a=[],d=o.slice(1).map((t,u)=>!e.slice(1).every(s=>isNaN(s[u+1])));return e.forEach(t=>{const u=t.filter((y,s)=>s===0||d[s-1]);a.push(u)}),a}const Z=document.getElementById("chartLoader"),j=document.querySelector(".chartSVG-wrapper");let _=parseInt(localStorage.getItem("currentPage")),X=localStorage.getItem("chartType");const K=6,$=JSON.parse(localStorage.getItem("chartData"))||[];_||(_=1,localStorage.setItem("currentPage",_));function ct(){Z.style.display="block",j.classList.add("blurred")}function st(){Z.style.display="none",j.classList.remove("blurred")}function Y(e){const o=document.getElementById("dataTable");o.innerHTML="";let a=parseInt(localStorage.getItem("currentPage"));const t=(localStorage.getItem("chartType")||"bar")==="pie"?1:K,u=e.length,y=e[0],s=document.createElement("tr");y.forEach(h=>{const g=document.createElement("th");g.textContent=h,s.appendChild(g)}),o.appendChild(s);const b=(a-1)*t+1,l=b+t;for(let h=1;h<u;h++){const g=e[h],f=document.createElement("tr");h>=b&&h<l&&u>t&&f.classList.add("highlight"),g.forEach(S=>{const I=document.createElement("td");I.textContent=S,f.appendChild(I)}),o.appendChild(f)}}function q(){const e=localStorage.getItem("chartType");let o=parseInt(localStorage.getItem("currentPage"));ct();const a=e==="pie"?1:K,d=(o-1)*a+1,t=$.slice(d,d+a),u=$.slice(0)[0][0],y=t.length>0?t[0][1]:"",b=lt($)[0].slice(1).map(m=>m===""?"":m),l=t.map(m=>m[0]),h=t.map(m=>m.slice(1)),g=getComputedStyle(document.body).getPropertyValue("--one-color").trim(),f=getComputedStyle(document.body).getPropertyValue("--two-color").trim(),v=getComputedStyle(document.body).getPropertyValue("--three-color").trim(),S=getComputedStyle(document.body).getPropertyValue("--four-color").trim(),I=getComputedStyle(document.body).getPropertyValue("--five-color").trim(),N=[g,f,v,S,I];setTimeout(()=>{chartSVG.innerHTML="",rt(e,h,l,b,N,chartSVG,u),at(b,N,y,e),st()},1500);const T=document.getElementById("scale-wrapper");e==="pie"?T.style.display="none":T.style.display="flex";const P=document.getElementById("pagination"),w=X==="pie"?$.length-1:Math.ceil(($.length-1)/a);w>1?(P.style.display="flex",document.getElementById("pageInfo").innerText=`${o} з ${w}`):P.style.display="none"}function Q(e){let o=parseInt(localStorage.getItem("currentPage"));const a=X==="pie"?1:K,d=X==="pie"?$.length-1:Math.ceil($.length/a),t=o+e;t<1?localStorage.setItem("currentPage",1):t>d?localStorage.setItem("currentPage",d):localStorage.setItem("currentPage",t),q(),Y($);let u=localStorage.getItem("currentPage");document.getElementById("pageInfo").innerText=`${u} з ${d}`}const F=document.getElementById("prevBtn"),J=document.getElementById("nextBtn");F.dataset.eventAttached||(F.addEventListener("click",e=>{console.log("Prev button clicked"),e.preventDefault(),Q(-1)}),F.dataset.eventAttached=!0);J.dataset.eventAttached||(J.addEventListener("click",e=>{console.log("Next button clicked"),e.preventDefault(),Q(1)}),J.dataset.eventAttached=!0);Y($);q();const V=JSON.parse(localStorage.getItem("chartData"))||[];let H=localStorage.getItem("chartType");H||(H="bar",localStorage.setItem("chartType",H));const G=document.querySelectorAll('input[name="chartType"]');G.forEach(e=>{e.value===H&&(e.checked=!0)});G.forEach(e=>{e.addEventListener("change",o=>{H=o.target.value,localStorage.setItem("chartType",H),q(),Y(V)})});const it=document.querySelectorAll(".type-wrapper label");it.forEach(e=>{e.addEventListener("click",()=>{const o=document.getElementById(e.getAttribute("for"));o&&(o.checked=!0,H=o.value,localStorage.setItem("chartType",H),q(),Y(V))})});let M=localStorage.getItem("gridSize")||0;const D=document.getElementById("scale-toggle"),z=document.getElementById("scale-menu");M&&(D.value=M);D.addEventListener("click",()=>{z.classList.toggle("hidden")});for(let e=10;e<=500;e+=10){const o=document.createElement("li");o.textContent=e,o.addEventListener("click",()=>{D.value=e,M=e,localStorage.setItem("gridSize",M),localStorage.getItem("chartType"),q(),z.classList.add("hidden"),console.log("Selected gridSize:",M)}),z.appendChild(o)}D.addEventListener("input",e=>{M=e.target.value,console.log("Entered gridSize:",M)});D.addEventListener("keydown",e=>{e.key==="Enter"&&(localStorage.setItem("gridSize",M),localStorage.getItem("chartType"),q(),z.classList.add("hidden"),console.log("GridSize saved and dropdown closed on Enter:",M))});document.addEventListener("click",function(e){!D.contains(e.target)&&!z.contains(e.target)&&z.classList.add("hidden")});const tt=document.getElementById("palette-btn"),R=document.getElementById("palette-dropdown");tt.addEventListener("click",function(e){R.classList.toggle("hidden"),e.stopPropagation()});document.querySelectorAll("#palette-dropdown li").forEach(function(e){e.addEventListener("click",function(){R.classList.add("hidden")})});document.addEventListener("click",function(e){!R.classList.contains("hidden")&&!tt.contains(e.target)&&R.classList.add("hidden")});document.querySelectorAll("#palette-dropdown li").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll("#palette-dropdown .dropdown-item").forEach(function(a){a.classList.remove("active")}),this.classList.add("active");const o=this.getAttribute("data-palette");document.body.className=document.body.className.replace(/\bpalette-\S+/g,""),document.body.classList.add(`palette-${o}`),localStorage.getItem("chartType"),q(),document.getElementById("palette-dropdown").classList.add("hidden")})});
